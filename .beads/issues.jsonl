{"id":"ts-6iq","title":"Farmer produce listing — CRUD with photos, pricing, categories","description":"Build the farmer-facing produce listing system:\n\nWeb (Next.js):\n1. Farmer dashboard at /[lang]/farmer/dashboard — shows active listings, pending orders, earnings\n2. Add listing page at /[lang]/farmer/listings/new — form with: category (dropdown from produce_categories), name, description, price per kg, available quantity, freshness date, photos (up to 5), location (auto from profile or pin on map)\n3. Edit listing at /[lang]/farmer/listings/[id]/edit\n4. Toggle listing active/inactive\n5. Photo upload to Supabase Storage (compress client-side before upload, max 1MB each)\n\nAPI:\n- POST /produce — create listing\n- PATCH /produce/:id — update\n- DELETE /produce/:id — soft delete (is_active=false)\n- GET /produce?farmer_id=X — farmer's own listings\n\nSeed produce_categories with ~30 common Nepal items:\nVegetables: tomato, potato, onion, cauliflower, cabbage, spinach, radish, carrot, beans, peas, chili, garlic, ginger, mushroom, cucumber\nFruits: apple, orange, banana, mango, guava, papaya, lemon, pomegranate\nGrains: rice, wheat, maize, millet\nDairy: milk, curd, ghee\n\nReference: spec.md Section 4.1, 5.1","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:06.286750743+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:06.286750743+05:45","labels":["area:farmer","phase:1"],"dependencies":[{"issue_id":"ts-6iq","depends_on_id":"ts-eob","type":"blocks","created_at":"2026-02-13T23:42:24.829311892+05:45","created_by":"mayor"},{"issue_id":"ts-6iq","depends_on_id":"ts-zdg","type":"blocks","created_at":"2026-02-13T23:42:25.001771182+05:45","created_by":"mayor"}]}
{"id":"ts-6ke","title":"OSM map integration — Leaflet for web, flutter_map for mobile","description":"Integrate OpenStreetMap across the platform:\n\nWeb (Leaflet + react-leaflet):\n1. Location picker component: click-to-pin on map, reverse geocode for address\n2. Produce listing map: show nearby listings as markers\n3. Trip route display: draw route polyline on map\n4. Order tracking map placeholder (real-time tracking is Phase 2)\n\nMobile (flutter_map):\n1. Same components: location picker, route display, listing markers\n2. GPS location access for rider tracking\n3. Offline tile caching for areas with poor connectivity (using flutter_map tile layer)\n\nShared:\n- Tile server: https://tile.openstreetmap.org/{z}/{x}/{y}.png (free, attribution required)\n- Geocoding: Nominatim (public instance, respect rate limits)\n- Routing: OSRM public demo server for MVP\n- Default map center: Jiri (27.6306, 86.2305) for the launch area\n- Nepal bounding box for map constraints: [26.347, 80.058] to [30.447, 88.201]\n\nReference: spec.md Section 3.3","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:35:01.995333418+05:45","created_by":"mayor","updated_at":"2026-02-13T23:35:01.995333418+05:45","labels":["area:maps","phase:1"],"dependencies":[{"issue_id":"ts-6ke","depends_on_id":"ts-apy","type":"blocks","created_at":"2026-02-13T23:42:26.311672675+05:45","created_by":"mayor"}]}
{"id":"ts-794","title":"Consumer marketplace — browse produce, search, filter, product detail","description":"Build the consumer-facing marketplace:\n\nWeb (Next.js, SSR for SEO):\n1. Marketplace page at /[lang]/marketplace — grid of produce listings\n   - Filter by: category, price range, location/distance\n   - Search by name (bilingual)\n   - Sort by: price, distance, freshness, rating\n   - Pagination (infinite scroll or page-based)\n   - Each card: photo, name, price/kg, farmer name+rating, distance, freshness\n2. Product detail at /[lang]/produce/[id] — full listing with all photos, farmer profile link, add to cart\n3. Category pages at /[lang]/marketplace/[category] — SEO-friendly category browsing\n4. Location picker: consumer sets their location (geolocation API or manual pin) to calculate distances\n\nSSR: Product detail pages must be server-rendered with proper meta tags (og:image, description) for sharing on Facebook/Viber.\n\nAPI:\n- GET /produce — with filters (category_id, min_price, max_price, lat, lng, radius_km, search, sort_by)\n- GET /produce/:id — single listing with farmer info\n\nReference: spec.md Section 4.2, 6.2","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:13.854702913+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:13.854702913+05:45","labels":["area:consumer","phase:1"],"dependencies":[{"issue_id":"ts-794","depends_on_id":"ts-eob","type":"blocks","created_at":"2026-02-13T23:42:24.484512069+05:45","created_by":"mayor"},{"issue_id":"ts-794","depends_on_id":"ts-zdg","type":"blocks","created_at":"2026-02-13T23:42:24.639113316+05:45","created_by":"mayor"}]}
{"id":"ts-8ap","title":"Landing page — hero, how it works, stats, CTA sections","description":"Build the JiriSewa landing page following ui.md flat design system:\n\nRoute: /[lang]/ (bilingual, default Nepali)\n\nSections (each is a bold color block per ui.md):\n1. HERO (Blue bg #3B82F6):\n   - Large heading: 'किसानबाट सिधै तपाईंको घरमा' / 'Fresh from farm to your door'\n   - Subheading explaining the three-sided marketplace concept\n   - Two CTAs: 'Browse Produce' (white button), 'Become a Rider' (outline border-4 white)\n   - Background decoration: large geometric shapes (circles, rotated squares) at low opacity\n   - Abstract illustration of farmer→rider→consumer flow using geometric shapes\n\n2. HOW IT WORKS (Dark gray #111827 bg, white text):\n   - 3 steps with large numbered circles\n   - Step 1 (Emerald icon): Farmer lists produce\n   - Step 2 (Amber icon): Rider posts trip\n   - Step 3 (Blue icon): Consumer orders, rider delivers\n   - Each step is a flat card with icon circle (h-16 w-16)\n\n3. STATS (White bg):\n   - Multi-color stat numbers per ui.md bold factor\n   - Stats: Farmers registered, KG delivered, Riders active, Avg savings %\n   - Use placeholder numbers for MVP\n\n4. FOR FARMERS (Emerald bg #10B981):\n   - Benefits of listing on JiriSewa\n   - CTA: 'Start Selling' button\n\n5. FOR RIDERS (Amber bg #F59E0B):\n   - Benefits of riding with JiriSewa\n   - CTA: 'Start Earning' button\n\n6. CTA SECTION (Blue bg):\n   - Final call to action\n   - Download / sign up prompt\n\n7. FOOTER (Dark gray bg):\n   - Links, contact (info@jirisewa.com), social placeholders\n   - OSM attribution\n\nAll sections: NO shadows, bold typography (Outfit 700/800), geometric purity, poster aesthetic.\nResponsive: mobile-first, stack on small screens, grid on large.\n\nReference: ui.md, spec.md Section 2","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:42:07.683939243+05:45","created_by":"mayor","updated_at":"2026-02-13T23:42:07.683939243+05:45","labels":["area:consumer","area:web","phase:1"],"dependencies":[{"issue_id":"ts-8ap","depends_on_id":"ts-eob","type":"blocks","created_at":"2026-02-13T23:42:24.316904994+05:45","created_by":"mayor"}]}
{"id":"ts-9ei","title":"Rider trip posting — create trips with route, capacity, schedule","description":"Build the rider trip management system:\n\nMobile (Flutter) + Web fallback:\n1. Post trip screen: origin (pin or search), destination (pin or search), departure date/time, available capacity (kg), vehicle type\n2. Route display: show calculated route on OSM map using OSRM\n3. My trips list: upcoming, active, completed\n4. Trip detail: route on map, matched orders, pickup/drop sequence\n5. Edit trip (only before departure)\n6. Cancel trip (notify matched orders)\n7. Start trip button → changes status to in_transit\n\nWeb (Next.js):\n- Rider dashboard at /[lang]/rider/dashboard\n- Post trip at /[lang]/rider/trips/new\n- Trip detail at /[lang]/rider/trips/[id]\n\nAPI:\n- POST /trips — create trip with origin, destination, departure_at, available_capacity_kg\n- GET /trips — list rider's trips (filter by status)\n- GET /trips/:id — trip detail with matched orders\n- PATCH /trips/:id — update trip\n- POST /trips/:id/start — mark in_transit\n- POST /trips/:id/complete — mark completed\n- DELETE /trips/:id — cancel (only if scheduled)\n\nRoute calculation:\n- Call OSRM API: GET /route/v1/driving/{origin_lng},{origin_lat};{dest_lng},{dest_lat}?overview=full\u0026geometries=geojson\n- Store route as LineString in rider_trips.route\n- Use public OSRM demo server for MVP (router.project-osrm.org)\n\nReference: spec.md Section 4.3, 6.3","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:28.341530192+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:28.341530192+05:45","labels":["area:rider","phase:1"],"dependencies":[{"issue_id":"ts-9ei","depends_on_id":"ts-eob","type":"blocks","created_at":"2026-02-13T23:42:25.165329751+05:45","created_by":"mayor"},{"issue_id":"ts-9ei","depends_on_id":"ts-zdg","type":"blocks","created_at":"2026-02-13T23:42:25.402508831+05:45","created_by":"mayor"},{"issue_id":"ts-9ei","depends_on_id":"ts-6ke","type":"blocks","created_at":"2026-02-13T23:42:25.578835683+05:45","created_by":"mayor"}]}
{"id":"ts-apy","title":"Project scaffolding — monorepo with Next.js web app, Flutter mobile app, Supabase config, shared packages","description":"Set up the monorepo structure:\n- apps/web/ — Next.js 15 with App Router, TypeScript, Tailwind CSS, bilingual [lang] routing\n- apps/mobile/ — Flutter project for rider + consumer mobile app\n- packages/database/ — Supabase migrations directory, type definitions\n- packages/shared/ — Shared constants, enums, validation schemas\n- supabase/ — config.toml, migrations dir, functions dir\n- Root package.json with pnpm workspaces\n- .gitignore, tsconfig base, ESLint config\n- README.md with setup instructions\n\nReference: spec.md Section 14 (Project Structure)","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:33:00.781704625+05:45","created_by":"mayor","updated_at":"2026-02-13T23:33:00.781704625+05:45","labels":["area:infra","phase:1"]}
{"id":"ts-e6l","title":"Rating system — post-delivery ratings for farmers and riders","description":"Implement the rating/review system:\n\n1. After order delivery is confirmed, prompt consumer to rate:\n   - Farmer: produce quality (1-5 stars + comment)\n   - Rider: delivery quality (1-5 stars + comment)\n2. Farmer can rate rider (cooperation, timeliness)\n3. Rider can rate farmer (produce readiness, accuracy)\n4. Rating display: show avg rating + count on user profiles, listing cards, trip listings\n5. Update users.rating_avg and users.rating_count via trigger or app logic\n6. Ratings are public and immutable (no editing/deleting)\n\nWeb:\n- Rating form as modal after delivery confirmation\n- Rating display on farmer profile, produce cards, rider profile\n\nAPI:\n- POST /orders/:id/rate — submit rating (validates: order is delivered, rater is party to order, hasn't already rated)\n- GET /users/:id/ratings — paginated list of ratings received\n\nReference: spec.md Section 5.1 (ratings table), Section 6.5","status":"open","priority":2,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:46.736023581+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:46.736023581+05:45","labels":["area:trust","phase:1"],"dependencies":[{"issue_id":"ts-e6l","depends_on_id":"ts-wtw","type":"blocks","created_at":"2026-02-13T23:42:26.737054851+05:45","created_by":"mayor"}]}
{"id":"ts-eob","title":"Design system setup — Tailwind tokens, Outfit font, base components","description":"Implement the design system from ui.md as reusable Tailwind config and base components:\n\nTailwind config (tailwind.config.ts):\n- Colors: primary=#3B82F6, secondary=#10B981, accent=#F59E0B, muted=#F3F4F6, foreground=#111827\n- Font: Outfit (Google Fonts import)\n- No shadow utilities used (shadow-none enforced)\n- Radius defaults: rounded-md (6px), rounded-lg (8px)\n\nBase components (apps/web/src/components/ui/):\n- Button: primary (solid blue, white text, h-14, hover:scale-105), secondary (gray-100 bg), outline (border-4, fill on hover)\n- Card: solid bg, no shadow, no border, p-6/p-8, rounded-lg, hover:scale-[1.02]\n- Input: bg-gray-100 normal, white bg + border-2 primary on focus\n- SectionBlock: alternating bg colors (white/muted/primary/secondary/accent), geometric decoration\n- IconCircle: lucide icon inside colored circle (h-14 w-14)\n- Badge: pill-shaped tag with accent colors\n\nAll components must follow ui.md strictly:\n- ZERO box shadows anywhere\n- Scale transforms for hover feedback\n- Outfit font, geometric aesthetic\n- Bold color blocking for sections\n- lucide-react for all icons\n\nReference: ui.md (entire document)","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:41:53.863897289+05:45","created_by":"mayor","updated_at":"2026-02-13T23:41:53.863897289+05:45","labels":["area:design","phase:1"],"dependencies":[{"issue_id":"ts-eob","depends_on_id":"ts-apy","type":"blocks","created_at":"2026-02-13T23:42:23.742670295+05:45","created_by":"mayor"}]}
{"id":"ts-fy1","title":"Bilingual i18n — Nepali and English with [lang] routing","description":"Implement bilingual support across the web app:\n\n1. Route structure: /[lang]/... where lang is 'en' or 'ne'\n2. Default language: ne (Nepali)\n3. Language switcher in header (toggle between en/ne)\n4. Translation files: JSON-based, one per language\n5. Server-side language detection: Accept-Language header → cookie → default ne\n6. All UI text, form labels, error messages, category names in both languages\n7. Produce listings have name_en and name_ne fields — show based on current lang\n8. SEO: hreflang tags, canonical URLs per language\n9. Date/number formatting: Nepali uses same numerals as English in practice (no Devanagari digits needed for MVP)\n\nUse next-intl or a lightweight i18n approach. Keep it simple — no ICU message format needed for MVP.\n\nReference: spec.md Section 12","status":"open","priority":2,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:53.380260589+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:53.380260589+05:45","labels":["area:i18n","phase:1"],"dependencies":[{"issue_id":"ts-fy1","depends_on_id":"ts-apy","type":"blocks","created_at":"2026-02-13T23:42:26.529047626+05:45","created_by":"mayor"}]}
{"id":"ts-hyk","title":"Phone OTP authentication — Supabase Auth with Nepal SMS provider","description":"Implement phone-number-based OTP authentication:\n\n1. Supabase Auth config for phone auth\n2. SMS provider integration (Sparrow SMS or Aakash SMS — pick whichever has a simpler API)\n3. Auth flow: enter phone → receive OTP → verify → JWT session\n4. Registration completion: after first OTP verify, collect name, location (pin on map), preferred language\n5. Role selection: farmer, consumer, rider (can select multiple)\n6. Role-specific fields: farm_name (farmer), vehicle_type + capacity (rider)\n7. Web: Next.js auth pages at /[lang]/auth/login and /[lang]/auth/register\n8. Mobile: Flutter auth screens\n\nNepali phone numbers: 98XXXXXXXX (10 digits). Validate format before sending OTP.\n\nReference: spec.md Section 4, Section 6.1","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:33:20.389051896+05:45","created_by":"mayor","updated_at":"2026-02-13T23:33:20.389051896+05:45","labels":["area:auth","phase:1"],"dependencies":[{"issue_id":"ts-hyk","depends_on_id":"ts-zdg","type":"blocks","created_at":"2026-02-13T23:42:24.098014225+05:45","created_by":"mayor"}]}
{"id":"ts-wtw","title":"Order system — cart, checkout, order lifecycle, pickup/delivery confirmation","description":"Build the full order lifecycle:\n\nConsumer flow (Web + Mobile):\n1. Cart: add items from marketplace, adjust quantities, see subtotals\n2. Checkout: review cart, set delivery address (pin on map), select delivery window from available rider trips, see delivery fee estimate\n3. Place order → creates order + order_items records, status=pending\n4. Order tracking page: shows current status, rider info (once matched), map (Phase 2)\n5. Confirm delivery: consumer taps confirm when produce received\n6. Rate: prompt to rate farmer and rider (1-5 stars + optional comment)\n\nRider flow (Mobile):\n1. See matched orders on trip dashboard\n2. Accept/decline individual orders\n3. Pickup: navigate to farmer, photograph produce, confirm pickup (both farmer and rider confirm in-app)\n4. Delivery: navigate to consumer, hand over produce, confirm delivery\n5. Collect cash from consumer (MVP payment)\n\nOrder matching (background):\n- When order is placed, find scheduled trips where:\n  - ST_DWithin(farmer.location, trip.route, 5000) — within 5km of route\n  - ST_DWithin(consumer.delivery_location, trip.route, 5000)\n  - trip.remaining_capacity_kg \u003e= order total weight\n  - trip.departure_at within consumer's delivery window\n- Rank by: least detour, highest rider rating, soonest departure\n- Notify top rider, first-accept wins\n- If no match in 24h, notify consumer\n\nStatus flow: pending → matched → picked_up → in_transit → delivered → (rated)\nCancel flow: pending/matched → cancelled (notify all parties)\n\nAPI: See spec.md Section 6.4\n\nReference: spec.md Section 4.2, 4.3, 5.1, 6.4, 8","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:34:40.503575603+05:45","created_by":"mayor","updated_at":"2026-02-13T23:34:40.503575603+05:45","labels":["area:orders","phase:1"],"dependencies":[{"issue_id":"ts-wtw","depends_on_id":"ts-794","type":"blocks","created_at":"2026-02-13T23:42:25.769796859+05:45","created_by":"mayor"},{"issue_id":"ts-wtw","depends_on_id":"ts-9ei","type":"blocks","created_at":"2026-02-13T23:42:25.972424553+05:45","created_by":"mayor"},{"issue_id":"ts-wtw","depends_on_id":"ts-6iq","type":"blocks","created_at":"2026-02-13T23:42:26.133888273+05:45","created_by":"mayor"}]}
{"id":"ts-zdg","title":"Database schema — core tables with PostGIS, RLS policies, indexes","description":"Create Supabase migrations for the core data model:\n\nTables:\n- users (id, phone, name, role, avatar_url, location Point, address, municipality, lang, rating_avg, rating_count)\n- user_roles (id, user_id, role, farm_name, vehicle_type, vehicle_capacity_kg, license_photo_url, verified)\n- produce_categories (id, name_en, name_ne, icon, sort_order)\n- produce_listings (id, farmer_id, category_id, name_en, name_ne, description, price_per_kg, available_qty_kg, freshness_date, location Point, photos text[], is_active)\n- rider_trips (id, rider_id, origin Point, origin_name, destination Point, destination_name, route LineString, departure_at, available_capacity_kg, remaining_capacity_kg, status enum)\n- orders (id, consumer_id, rider_trip_id, rider_id, status enum, delivery_address, delivery_location Point, total_price, delivery_fee, payment_method, payment_status)\n- order_items (id, order_id, listing_id, farmer_id, quantity_kg, price_per_kg, subtotal, pickup_location Point, pickup_confirmed, pickup_photo_url, delivery_confirmed)\n- ratings (id, order_id, rater_id, rated_id, role_rated, score 1-5, comment)\n- rider_location_log (id, rider_id, trip_id, location Point, speed_kmh, recorded_at) — partitioned, 7-day TTL\n\nPostGIS indexes on all geography columns. RLS policies: users see own data, public read on listings/categories.\n\nReference: spec.md Section 5","status":"open","priority":1,"issue_type":"task","owner":"krantiutils@users.noreply.github.com","created_at":"2026-02-13T23:33:14.724072058+05:45","created_by":"mayor","updated_at":"2026-02-13T23:33:14.724072058+05:45","labels":["area:database","phase:1"],"dependencies":[{"issue_id":"ts-zdg","depends_on_id":"ts-apy","type":"blocks","created_at":"2026-02-13T23:42:23.89138067+05:45","created_by":"mayor"}]}
